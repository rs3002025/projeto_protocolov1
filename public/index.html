<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sistema de Protocolo</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #f5f5f5;
    }
    .container {
      max-width: 1000px;
      margin: 40px auto;
      background: #fff;
      border-radius: 16px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      overflow: hidden;
      padding-bottom: 30px;
    }
    .header {
      background: #2e7d32;
      color: white;
      padding: 20px;
      text-align: center;
    }
    .content {
      padding: 20px 30px;
    }
    .menu, .login-screen, .form-screen, .protocolos-screen, .config-screen, .meus-protocolos-screen {
      display: none;
    }
    .active {
      display: block;
    }
    .formulario {
      display: grid;
      grid-template-columns: repeat(12, 1fr);
      gap: 15px 20px;
    }
    .form-group {
      display: flex;
      flex-direction: column;
    }
    .full-row { grid-column: span 12; }
    .span-6 { grid-column: span 6; }
    .span-4 { grid-column: span 4; }
    .span-3 { grid-column: span 3; }
    .span-2 { grid-column: span 2; }
    label { margin-bottom: 5px; font-weight: 600; }
    input, select, textarea {
      border: 1px solid #ccc;
      border-radius: 6px;
      padding: 8px;
      font-size: 1em;
    }
    button {
      padding: 10px 20px;
      border: none;
      background: #2e7d32;
      color: white;
      border-radius: 8px;
      cursor: pointer;
      margin: 5px 10px 5px 0;
    }
    .log-area {
      margin-top: 20px;
      font-size: 0.9em;
      background: #eee;
      padding: 10px;
      border-radius: 6px;
      min-height: 24px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: left;
      vertical-align: top;
    }
    th {
      background-color: #e0e0e0;
    }
    details {
      margin-top: 5px;
      font-size: 0.9em;
    }
    summary {
      cursor: pointer;
      font-weight: bold;
      color: #2e7d32;
    }

    /* Estilo para o documento PDF / impress√£o */
    #modeloProtocolo {
      display: none;
      padding: 40px;
      width: 800px;
      margin: auto;
      font-family: serif;
      color: #000;
    }
    #modeloProtocolo h2, #modeloProtocolo h3, #modeloProtocolo h4 {
      margin: 0;
      padding: 0;
    }
    #modeloProtocolo p {
      margin: 6px 0;
    }
  </style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

</head>
<body>
  <div class="container">
    <div class="header">
      <h2>Prefeitura de Morada Nova</h2>
      <h3>Sistema de Protocolo</h3>
    </div>

    <div id="login" class="login-screen active content">
      <label>Usu√°rio</label>
      <input type="text" id="usuario" />
      <label>Senha</label>
      <input type="password" id="senha" />
      <button onclick="logar()">Entrar</button>
      <p id="loginMsg" style="color:red;"></p>
    </div>

    <div id="menu" class="menu content">
      <button id="btnNovo" onclick="mostrarTela('form')">Novo Protocolo</button>
      <button onclick="mostrarTela('protocolos')">Todos os Protocolos</button>
      <button onclick="mostrarTela('meusProtocolos')">Meus Protocolos</button>
      <button id="btnConfig" onclick="mostrarTela('config')">‚öôÔ∏è Configura√ß√µes</button>
      <button onclick="sair()">Sair</button>
    </div>

    <div id="form" class="form-screen content">
      <form class="formulario" onsubmit="return false;">
        <div class="form-group span-3"><label>N√∫mero do Protocolo</label><input type="text" id="numeroProtocolo" readonly></div>
        <div class="form-group span-3"><label>Matr√≠cula</label><input type="text" id="matricula"></div>
        <div class="form-group span-9"><label>Nome Completo</label><input type="text" id="nome"></div>
        <div class="form-group span-6"><label>Endere√ßo</label><input type="text" id="endereco"></div>
        <div class="form-group span-3"><label>Munic√≠pio</label><input type="text" id="municipio"></div>
        <div class="form-group span-3"><label>Bairro</label><input type="text" id="bairro"></div>
        <div class="form-group span-3"><label>CEP</label><input type="text" id="cep"></div>
        <div class="form-group span-3"><label>Telefone</label><input type="text" id="telefone"></div>
        <div class="form-group span-3"><label>CPF</label><input type="text" id="cpf"></div>
        <div class="form-group span-3"><label>RG</label><input type="text" id="rg"></div>
        <div class="form-group span-3"><label>Data de Expedi√ß√£o</label><input type="date" id="dataExpedicao"></div>
        <div class="form-group span-3"><label>Cargo/Fun√ß√£o</label><input type="text" id="cargo"></div>
        <div class="form-group span-3"><label>Lota√ß√£o</label><input type="text" id="lotacao"></div>
        <div class="form-group span-6"><label>Unidade de Exerc√≠cio</label><input type="text" id="unidade"></div>
        <div class="form-group span-6"><label>Tipo de Requerimento</label><input type="text" id="tipo"></div>
        <div class="form-group span-6"><label>Requer ao</label><input type="text" id="requerAo"></div>
        <div class="form-group span-3"><label>Data Solicita√ß√£o</label><input type="date" id="dataSolicitacao"></div>
        <div class="form-group full-row"><label>Informa√ß√µes Complementares</label><textarea id="complemento"></textarea></div>
      </form>
      <button onclick="enviarRequerimento()">Enviar Requerimento</button>
      <button onclick="window.print()">Imprimir</button>
      <button onclick="mostrarTela('menu')">Voltar</button>
      <div id="log" class="log-area"></div>
    </div>

    <div id="protocolos" class="protocolos-screen content">
      <h3>üìã Lista de Protocolos Enviados</h3>
      <table>
        <thead>
          <tr>
            <th>Matr√≠cula</th>
            <th>Nome</th>
            <th>Tipo</th>
            <th>Status</th>
            <th>Respons√°vel</th>
            <th>A√ß√£o</th>
          </tr>
        </thead>
        <tbody id="tabelaProtocolos"></tbody>
      </table>
      <button onclick="mostrarTela('menu')">Voltar</button>
    </div>

    <div id="meusProtocolos" class="meus-protocolos-screen content">
      <h3>üìÇ Meus Protocolos</h3>
      <table>
        <thead>
          <tr>
            <th>N√∫mero</th>
            <th>Nome</th>
            <th>Status</th>
            <th>A√ß√£o</th>
          </tr>
        </thead>
        <tbody id="meusProtocolosTabela"></tbody>
      </table>
      <button onclick="voltarDeMeusProtocolos()">Voltar</button>
    </div>

    <div id="config" class="config-screen content">
      <h3>‚öôÔ∏è Configura√ß√µes</h3>
      <div class="form-group full-row">
        <label>Email do Sistema:</label>
        <input type="email" id="emailSistemaConfig" />
        <button onclick="salvarEmailSistema()">Salvar Email</button>
      </div>
      <div class="form-group full-row">
        <label>Adicionar Novo Usu√°rio:</label>
        <input type="text" id="novoUsuario" placeholder="Nome do usu√°rio" />
        <input type="password" id="novaSenha" placeholder="Senha" />
        <select id="nivelUsuario">
          <option value="comum">Comum</option>
          <option value="padrao">Padr√£o</option>
          <option value="admin">Administrador</option>
        </select>
        <button onclick="cadastrarUsuario()">Cadastrar Usu√°rio</button>
      </div>
      <h4>Usu√°rios Cadastrados:</h4>
      <ul id="listaUsuarios"></ul>
      <button onclick="mostrarTela('menu')">Voltar</button>
    </div>
  </div>

 <!-- Modelo padr√£o do protocolo para impress√£o/PDF -->
<div id="modeloProtocolo" style="display:none; width: 800px; margin: auto; font-family: 'Times New Roman', serif; color: #000; background: #fff; padding: 40px; border: 1px solid #333; box-shadow: 0 0 15px rgba(0,0,0,0.3);">
  <style>
    #modeloProtocolo h2, #modeloProtocolo h3, #modeloProtocolo h4 {
      margin: 0;
      padding: 0;
      font-weight: normal;
    }
    #modeloProtocolo h2 {
      font-size: 26px;
      font-weight: bold;
      color: #2e7d32;
      margin-bottom: 5px;
    }
    #modeloProtocolo h3 {
      font-size: 20px;
      margin-top: 10px;
      margin-bottom: 25px;
      font-weight: bold;
      text-decoration: underline;
    }
    #modeloProtocolo h4 {
      font-size: 16px;
      margin-top: 20px;
      margin-bottom: 10px;
      color: #2e7d32;
      border-bottom: 1px solid #2e7d32;
      padding-bottom: 5px;
    }
    #modeloProtocolo p {
      font-size: 14px;
      margin: 5px 0;
      line-height: 1.5;
    }
    #modeloProtocolo strong {
      color: #2e7d32;
    }
    #modeloProtocolo #doc_complemento {
      border: 1px solid #ccc;
      min-height: 80px;
      padding: 10px;
      margin-top: 5px;
      font-size: 13px;
      white-space: pre-wrap;
      background-color: #f9f9f9;
    }
    #modeloProtocolo .assinaturas {
      display: flex;
      justify-content: space-between;
      margin-top: 80px;
    }
    #modeloProtocolo .assinatura {
      text-align: center;
      width: 40%;
      font-size: 14px;
      border-top: 1px solid #000;
      padding-top: 8px;
      color: #444;
    }
  </style>
  <div style="text-align: center; border-bottom: 3px solid #2e7d32; padding-bottom: 15px; margin-bottom: 30px;">
    <h2>Prefeitura Municipal de Morada Nova</h2>
    <h4>Setor de Protocolo</h4>
    <h3>PROTOCOLO DE REQUERIMENTO</h3>
  </div>
  <p><strong>N√∫mero do Protocolo:</strong> <span id="doc_numero"></span></p>
  <p><strong>Data de Solicita√ß√£o:</strong> <span id="doc_dataSolicitacao"></span></p>

  <h4>Dados do Requerente</h4>
  <p><strong>Nome:</strong> <span id="doc_nome"></span></p>
  <p><strong>Matr√≠cula:</strong> <span id="doc_matricula"></span></p>
  <p><strong>CPF:</strong> <span id="doc_cpf"></span> | <strong>RG:</strong> <span id="doc_rg"></span></p>
  <p><strong>Endere√ßo:</strong> <span id="doc_endereco"></span>, <span id="doc_bairro"></span> - <span id="doc_municipio"></span> - CEP: <span id="doc_cep"></span></p>
  <p><strong>Telefone:</strong> <span id="doc_telefone"></span></p>
  <p><strong>Cargo/Fun√ß√£o:</strong> <span id="doc_cargo"></span></p>
  <p><strong>Lota√ß√£o:</strong> <span id="doc_lotacao"></span></p>
  <p><strong>Unidade de Exerc√≠cio:</strong> <span id="doc_unidade"></span></p>

  <h4>Dados do Requerimento</h4>
  <p><strong>Tipo de Requerimento:</strong> <span id="doc_tipo"></span></p>
  <p><strong>Requer ao:</strong> <span id="doc_requerAo"></span></p>

  <p><strong>Informa√ß√µes Complementares:</strong></p>
  <div id="doc_complemento"></div>

  <div class="assinaturas">
    <div class="assinatura">
      Assinatura do Requerente
    </div>
    <div class="assinatura">
      Respons√°vel pelo Protocolo
    </div>
  </div>
</div>


  <script>
    let usuarios = JSON.parse(localStorage.getItem('usuarios')) || [];
    if (!usuarios.length) {
      usuarios = [
        { nome: "admin", senha: "123", nivel: "admin" },
        { nome: "user", senha: "123", nivel: "comum" }
      ];
    }

    let emailSistema = localStorage.getItem('emailSistema') || "";
    let dadosEnviados = JSON.parse(localStorage.getItem('protocolos')) || [];
    let usuarioLogado = "";
    let nivelUsuario = "";

    function logar() {
      const user = document.getElementById('usuario').value;
      const senha = document.getElementById('senha').value;
      const msg = document.getElementById('loginMsg');
      const usuarioValido = usuarios.find(u => u.nome === user && u.senha === senha);
      if (usuarioValido) {
        usuarioLogado = user;
        nivelUsuario = usuarioValido.nivel || "comum";

        document.getElementById('btnConfig').style.display = nivelUsuario === "admin" ? "inline-block" : "none";
        document.getElementById('btnNovo').style.display = (nivelUsuario === "admin" || nivelUsuario === "padrao") ? "inline-block" : "none";

        if (nivelUsuario === "comum") {
          mostrarTela('meusProtocolos');
        } else {
          mostrarTela('menu');
        }

        msg.textContent = "";
        document.getElementById('usuario').value = "";
        document.getElementById('senha').value = "";
        atualizarListaUsuarios();
      } else {
        msg.textContent = "Usu√°rio ou senha incorretos.";
      }
    }

    function mostrarTela(tela) {
      ['login','menu','form','config','protocolos','meusProtocolos'].forEach(id => document.getElementById(id).classList.remove('active'));
      document.getElementById(tela).classList.add('active');
      if (tela === 'protocolos') listarProtocolos();
      if (tela === 'meusProtocolos') listarMeusProtocolos();
      if (tela === 'form') gerarNumeroProtocolo();
    }

    function sair() {
      mostrarTela('login');
      usuarioLogado = "";
      nivelUsuario = "";
      document.getElementById('usuario').value = "";
      document.getElementById('senha').value = "";
    }

    function gerarNumeroProtocolo() {
      const now = new Date();
      const pad = n => String(n).padStart(2, '0');
      const numero = `PROTO-${now.getFullYear()}${pad(now.getMonth()+1)}${pad(now.getDate())}-${pad(now.getHours())}${pad(now.getMinutes())}${pad(now.getSeconds())}`;
      document.getElementById('numeroProtocolo').value = numero;
      document.getElementById('log').innerText = 'üìÑ N√∫mero gerado: ' + numero;
    }

    function enviarRequerimento() {
      const dataAgora = new Date().toLocaleString();
      const protocolo = {
        numero: document.getElementById('numeroProtocolo').value,
        matricula: document.getElementById('matricula').value,
        nome: document.getElementById('nome').value,
        endereco: document.getElementById('endereco').value,
        municipio: document.getElementById('municipio').value,
        bairro: document.getElementById('bairro').value,
        cep: document.getElementById('cep').value,
        telefone: document.getElementById('telefone').value,
        cpf: document.getElementById('cpf').value,
        rg: document.getElementById('rg').value,
        dataExpedicao: document.getElementById('dataExpedicao').value,
        cargo: document.getElementById('cargo').value,
        lotacao: document.getElementById('lotacao').value,
        unidade: document.getElementById('unidade').value,
        tipo: document.getElementById('tipo').value,
        requerAo: document.getElementById('requerAo').value,
        dataSolicitacao: document.getElementById('dataSolicitacao').value,
        complemento: document.getElementById('complemento').value,
        dataEnvio: dataAgora,
        status: "Enviado",
        responsavel: usuarioLogado,
        movimentacoes: [
          { data: dataAgora, acao: "Criado e enviado", autor: usuarioLogado }
        ]
      };
      dadosEnviados.push(protocolo);
      localStorage.setItem('protocolos', JSON.stringify(dadosEnviados));
      document.getElementById('log').innerText = '‚úÖ Protocolo enviado em ' + dataAgora;

      document.querySelector('.formulario').reset();
    }

    function listarProtocolos() {
      const tbody = document.getElementById('tabelaProtocolos');
      tbody.innerHTML = "";
      dadosEnviados.forEach((p, i) => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${p.matricula}</td>
          <td>${p.nome}</td>
          <td>${p.tipo}</td>
          <td>${p.status}</td>
          <td>${p.responsavel}</td>
          <td><button onclick="encaminharProtocolo(${i})">Encaminhar</button></td>`;
        tbody.appendChild(tr);
      });
    }

    function listarMeusProtocolos() {
      const tbody = document.getElementById('meusProtocolosTabela');
      tbody.innerHTML = "";
      dadosEnviados.forEach((p, i) => {
        if (p.responsavel === usuarioLogado) {
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td>${p.numero || (i+1)}</td>
            <td>${p.nome}</td>
            <td>${p.status}</td>
            <td>
              <button onclick="atualizarStatus(${i})">Atualizar</button>
              <button onclick="encaminharProtocolo(${i})">Encaminhar</button>
              <button onclick="mostrarDetalhes(${i})">Ver Detalhes</button>
              <button onclick="gerarDocumento(${i})">üìÑ Documento</button>
              <details>
                <summary>Hist√≥rico</summary>
                ${p.movimentacoes?.map(m => `<div>${m.data} - ${m.acao} por ${m.autor}</div>`).join('') || ''}
              </details>
            </td>`;
          tbody.appendChild(tr);
        }
      });
    }

    function encaminharProtocolo(index) {
      const novoResp = prompt("Para qual usu√°rio deseja encaminhar?");
      if (novoResp) {
        const dataAgora = new Date().toLocaleString();
        dadosEnviados[index].responsavel = novoResp;
        dadosEnviados[index].status = "Encaminhado";
        dadosEnviados[index].movimentacoes.push({ data: dataAgora, acao: "Encaminhado", autor: usuarioLogado });
        localStorage.setItem('protocolos', JSON.stringify(dadosEnviados));
        listarProtocolos();
        if (nivelUsuario === "comum") {
          listarMeusProtocolos();
        }
      }
    }

    function atualizarStatus(index) {
      const novoStatus = prompt("Digite o novo status:", dadosEnviados[index].status);
      if (novoStatus) {
        const dataAgora = new Date().toLocaleString();
        dadosEnviados[index].status = novoStatus;
        dadosEnviados[index].movimentacoes.push({ data: dataAgora, acao: "Status atualizado para " + novoStatus, autor: usuarioLogado });
        localStorage.setItem('protocolos', JSON.stringify(dadosEnviados));
        listarMeusProtocolos();
      }
    }

    function mostrarDetalhes(index) {
      const p = dadosEnviados[index];
      const campos = [
        ['N√∫mero', p.numero],
        ['Matr√≠cula', p.matricula],
        ['Nome Completo', p.nome],
        ['Endere√ßo', p.endereco],
        ['Munic√≠pio', p.municipio],
        ['Bairro', p.bairro],
        ['CEP', p.cep],
        ['Telefone', p.telefone],
        ['CPF', p.cpf],
        ['RG', p.rg],
        ['Data de Expedi√ß√£o', p.dataExpedicao],
        ['Cargo/Fun√ß√£o', p.cargo],
        ['Lota√ß√£o', p.lotacao],
        ['Unidade de Exerc√≠cio', p.unidade],
        ['Tipo de Requerimento', p.tipo],
        ['Requer ao', p.requerAo],
        ['Data Solicita√ß√£o', p.dataSolicitacao],
        ['Informa√ß√µes Complementares', p.complemento]
      ];
      let detalhes = "Detalhes do Protocolo:\n\n";
      campos.forEach(c => {
        detalhes += `${c[0]}: ${c[1] || ''}\n`;
      });
      alert(detalhes);
    }

    function salvarEmailSistema() {
      emailSistema = document.getElementById('emailSistemaConfig').value;
      localStorage.setItem('emailSistema', emailSistema);
      alert("Email salvo com sucesso!");
    }

    function cadastrarUsuario() {
      const novo = document.getElementById('novoUsuario').value;
      const senha = document.getElementById('novaSenha').value;
      const nivel = document.getElementById('nivelUsuario').value;
      if (novo && senha && nivel) {
        usuarios.push({ nome: novo, senha: senha, nivel: nivel });
        localStorage.setItem('usuarios', JSON.stringify(usuarios));
        alert("Usu√°rio cadastrado!");
        atualizarListaUsuarios();
      }
    }

    function atualizarListaUsuarios() {
      const ul = document.getElementById('listaUsuarios');
      ul.innerHTML = "";
      usuarios.forEach(u => {
        const li = document.createElement('li');
        li.textContent = `${u.nome} (${u.nivel})`;
        ul.appendChild(li);
      });
    }

    function voltarDeMeusProtocolos() {
      if (nivelUsuario === 'comum') {
        sair();
      } else {
        mostrarTela('menu');
      }
    }

function gerarDocumento(index) {
  const p = dadosEnviados[index];
  if (!p) {
    alert("Protocolo n√£o encontrado.");
    return;
  }

  const html = `
  <html>
  <head>
    <title>Protocolo - ${p.numero}</title>
    <style>
      body {
        font-family: 'Times New Roman', serif;
        margin: 40px;
        color: #000;
        background: #fff;
      }
      .container {
        width: 21cm; /* A4 width */
        min-height: 29.7cm; /* A4 height */
        padding: 30px 40px;
        border: 1px solid #333;
        box-sizing: border-box;
        box-shadow: 0 0 15px rgba(0,0,0,0.3);
        margin: auto;
      }
      .header {
        text-align: center;
        border-bottom: 3px solid #2e7d32;
        padding-bottom: 15px;
        margin-bottom: 30px;
      }
      .header h2 {
        margin: 0;
        font-size: 26px;
        font-weight: bold;
        color: #2e7d32;
      }
      .header h4 {
        margin: 0;
        font-size: 16px;
        color: #2e7d32;
        font-weight: normal;
      }
      .header h3 {
        margin: 10px 0 0 0;
        font-size: 20px;
        font-weight: bold;
        text-decoration: underline;
      }
      h4.section-title {
        font-size: 16px;
        color: #2e7d32;
        border-bottom: 1px solid #2e7d32;
        padding-bottom: 5px;
        margin-top: 30px;
        margin-bottom: 15px;
      }
      p {
        font-size: 14px;
        line-height: 1.5;
        margin: 6px 0;
      }
      strong {
        color: #2e7d32;
      }
      #complemento {
        border: 1px solid #ccc;
        min-height: 80px;
        padding: 10px;
        margin-top: 5px;
        background-color: #f9f9f9;
        white-space: pre-wrap;
        font-size: 13px;
      }
      .assinaturas {
        margin-top: 80px;
        display: flex;
        justify-content: space-between;
      }
      .assinatura {
        width: 40%;
        text-align: center;
        font-size: 14px;
        border-top: 1px solid #000;
        padding-top: 8px;
        color: #444;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h2>Prefeitura Municipal de Morada Nova</h2>
        <h4>Setor de Protocolo</h4>
        <h3>PROTOCOLO DE REQUERIMENTO</h3>
      </div>

      <p><strong>N√∫mero do Protocolo:</strong> ${p.numero || ""}</p>
      <p><strong>Data de Solicita√ß√£o:</strong> ${p.dataSolicitacao || ""}</p>

      <h4 class="section-title">Dados do Requerente</h4>
      <p><strong>Nome:</strong> ${p.nome || ""}</p>
      <p><strong>Matr√≠cula:</strong> ${p.matricula || ""}</p>
      <p><strong>CPF:</strong> ${p.cpf || ""} | <strong>RG:</strong> ${p.rg || ""}</p>
      <p><strong>Endere√ßo:</strong> ${p.endereco || ""}, ${p.bairro || ""} - ${p.municipio || ""} - CEP: ${p.cep || ""}</p>
      <p><strong>Telefone:</strong> ${p.telefone || ""}</p>
      <p><strong>Cargo/Fun√ß√£o:</strong> ${p.cargo || ""}</p>
      <p><strong>Lota√ß√£o:</strong> ${p.lotacao || ""}</p>
      <p><strong>Unidade de Exerc√≠cio:</strong> ${p.unidade || ""}</p>

      <h4 class="section-title">Dados do Requerimento</h4>
      <p><strong>Tipo de Requerimento:</strong> ${p.tipo || ""}</p>
      <p><strong>Requer ao:</strong> ${p.requerAo || ""}</p>

      <p><strong>Informa√ß√µes Complementares:</strong></p>
      <div id="complemento">${p.complemento ? p.complemento.replace(/\n/g, '<br>') : ""}</div>

      <div class="assinaturas">
        <div class="assinatura">Assinatura do Requerente</div>
        <div class="assinatura">Respons√°vel pelo Protocolo</div>
      </div>
    </div>
  </body>
  </html>
  `;

  const janela = window.open('', '_blank', 'width=900,height=1200');
  janela.document.write(html);
  janela.document.close();

  janela.focus();
  // Dar tempo para renderizar antes de chamar print
  setTimeout(() => {
    janela.print();
    // janela.close(); // opcional fechar ap√≥s imprimir
  }, 500);
}


  </script>

</body>
</html>
