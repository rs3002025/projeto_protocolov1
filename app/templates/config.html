{% extends "base.html" %}

{% block title %}Configurações - Sistema de Protocolo{% endblock %}

{% block content %}
<div id="config" class="config-screen content active">
    <h3>⚙️ Configurações</h3>
    <div class="form-group full-row">
      <label>Email do Sistema:</label>
      <input type="email" id="emailSistemaConfig" />
      <button onclick="salvarEmailSistema()">Salvar Email</button>
    </div>
    <hr style="margin: 20px 0;">

    <h4>Adicionar Novo Usuário</h4>
    <form class="formulario" onsubmit="return false;" style="gap: 15px;">
        <div class="form-group span-6"><input type="text" id="nomeCompleto" placeholder="Nome completo" /></div>
        <div class="form-group span-6"><input type="text" id="novoUsuario" placeholder="Nome de usuário" /></div>
        <div class="form-group span-6"><input type="password" id="novaSenha" placeholder="Senha" /></div>
        <div class="form-group span-6">
            <select id="nivelUsuario">
                <option value="usuario">Usuário</option>
                <option value="comum">Comum</option>
                <option value="padrao">Padrão</option>
                <option value="admin">Administrador</option>
            </select>
        </div>
        <div class="form-group full-row">
            <button onclick="cadastrarUsuario()">Cadastrar Usuário</button>
        </div>
    </form>
    <hr style="margin: 20px 0;">
    <h4>Usuários Cadastrados</h4>
    <table style="width:100%;">
      <thead>
        <tr>
          <th>Nome</th><th>Login</th><th>Tipo</th><th style="width: 280px;">Ações</th>
        </tr>
      </thead>
      <tbody id="tabelaUsuarios"></tbody>
    </table>
    <hr style="margin: 20px 0;">
    <h4>Gerenciar Listas</h4>
    <h5>Tipos de Requerimento</h5>
    <div class="form-group" style="flex-direction: row; gap: 10px; align-items: center;">
        <input type="text" id="novoTipoNome" placeholder="Nome do novo tipo" style="flex-grow: 1;">
        <button onclick="adicionarItem('tipos')">Adicionar</button>
    </div>
    <table style="width:100%;">
        <thead><tr><th>Nome</th><th>Status</th><th style="width: 120px;">Ações</th></tr></thead>
        <tbody id="tabelaTipos"></tbody>
    </table>
    <br>
    <h5>Lotações</h5>
    <div class="form-group" style="flex-direction: row; gap: 10px; align-items: center;">
        <input type="text" id="novaLotacaoNome" placeholder="Nome da nova lotação" style="flex-grow: 1;">
        <button onclick="adicionarItem('lotacoes')">Adicionar</button>
    </div>
    <table style="width:100%;">
        <thead><tr><th>Nome</th><th>Status</th><th style="width: 120px;">Ações</th></tr></thead>
        <tbody id="tabelaLotacoes"></tbody>
    </table>
    <hr style="margin: 20px 0;">
    <h4>Gerar Backup de Protocolos</h4>
    <label>Data Início:</label>
    <input type="date" id="backupDataInicio" />
    <label>Data Fim:</label>
    <input type="date" id="backupDataFim" />
    <button onclick="gerarBackup()">Gerar Backup</button>
    <br><br>
    <a href="{{ url_for('main.menu') }}" class="button-link">Voltar</a>
</div>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        atualizarListaUsuarios();
        carregarTabelaGestao('tipos');
        carregarTabelaGestao('lotacoes');
    });
</script>
{% endblock %}
