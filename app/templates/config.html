{% extends "base.html" %}

{% block title %}Configurações - Sistema de Protocolo{% endblock %}

{% block content %}
<div id="config" class="config-screen content active">
    <h3>⚙️ Configurações Gerais</h3>

    <div class="form-group">
        <label for="emailSistemaConfig">Email do Sistema</label>
        <div style="display: flex; gap: 10px;">
            <input type="email" id="emailSistemaConfig" style="flex-grow: 1;"/>
            <button onclick="salvarEmailSistema()" style="margin-top: 0;">Salvar</button>
        </div>
    </div>

    <h4 style="margin-top: 30px; padding-top: 20px; border-top: 1px solid var(--border-color);">Adicionar Novo Usuário</h4>
    <form class="formulario" onsubmit="cadastrarUsuario(); return false;">
        <div class="form-group span-3"><label for="nomeCompleto">Nome Completo</label><input type="text" id="nomeCompleto" placeholder="Nome completo do usuário" /></div>
        <div class="form-group span-3"><label for="novoUsuario">Login</label><input type="text" id="novoUsuario" placeholder="Nome de usuário" /></div>
        <div class="form-group span-3"><label for="novaSenha">Senha</label><input type="password" id="novaSenha" placeholder="Senha inicial" /></div>
        <div class="form-group span-3"><label for="nivelUsuario">Tipo de Acesso</label>
            <select id="nivelUsuario">
                <option value="usuario">Usuário</option>
                <option value="comum">Comum</option>
                <option value="padrao">Padrão</option>
                <option value="admin">Administrador</option>
            </select>
        </div>
        <div class="form-group full-row">
            <button type="submit">Cadastrar Usuário</button>
        </div>
    </form>

    <h4 style="margin-top: 30px; padding-top: 20px; border-top: 1px solid var(--border-color);">Usuários Cadastrados</h4>
    <table>
      <thead>
        <tr>
          <th>Nome</th><th>Login</th><th>Tipo</th><th style="width: 280px;">Ações</th>
        </tr>
      </thead>
      <tbody id="tabelaUsuarios"></tbody>
    </table>

    <h4 style="margin-top: 30px; padding-top: 20px; border-top: 1px solid var(--border-color);">Gerenciar Listas</h4>
    <h5>Tipos de Requerimento</h5>
    <div class="form-group">
        <div style="display: flex; gap: 10px;">
            <input type="text" id="novoTipoNome" placeholder="Nome do novo tipo" style="flex-grow: 1;">
            <button onclick="adicionarItem('tipos')" style="margin-top: 0;">Adicionar</button>
        </div>
    </div>
    <table>
        <thead><tr><th>Nome</th><th>Status</th><th style="width: 120px;">Ações</th></tr></thead>
        <tbody id="tabelaTipos"></tbody>
    </table>
    <br>
    <h5>Lotações</h5>
    <div class="form-group">
        <div style="display: flex; gap: 10px;">
            <input type="text" id="novaLotacaoNome" placeholder="Nome da nova lotação" style="flex-grow: 1;">
            <button onclick="adicionarItem('lotacoes')" style="margin-top: 0;">Adicionar</button>
        </div>
    </div>
    <table>
        <thead><tr><th>Nome</th><th>Status</th><th style="width: 120px;">Ações</th></tr></thead>
        <tbody id="tabelaLotacoes"></tbody>
    </table>

    <h4 style="margin-top: 30px; padding-top: 20px; border-top: 1px solid var(--border-color);">Gerar Backup de Protocolos</h4>
    <div class="formulario">
        <div class="form-group span-3"><label for="backupDataInicio">Data Início</label><input type="date" id="backupDataInicio" /></div>
        <div class="form-group span-3"><label for="backupDataFim">Data Fim</label><input type="date" id="backupDataFim" /></div>
        <div class="form-group full-row"><button onclick="gerarBackup()">Gerar Backup</button></div>
    </div>

    <br><br>
    <a href="{{ url_for('main.menu') }}" class="button-link">Voltar</a>
</div>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        atualizarListaUsuarios();
        carregarTabelaGestao('tipos');
        carregarTabelaGestao('lotacoes');
    });
</script>
{% endblock %}
