{% extends "base.html" %}

{% block title %}Novo Protocolo - Sistema de Protocolo{% endblock %}

{% block content %}
<div id="form" class="form-screen content active">
    <form class="formulario" onsubmit="return false;">
      <div class="form-group span-3"><label>Número do Protocolo</label><input type="text" id="numeroProtocolo" readonly></div>
      <div class="form-group span-3"><label>Matrícula</label><input type="text" id="matricula"></div>
      <div class="form-group span-5">
          <label>Nome Completo</label>
          <input type="text" id="nome">
      </div>
      <div class="form-group span-1" style="justify-content: flex-end; align-items: flex-end;">
          <button id="btnBuscarNome" onclick="abrirModalBuscaServidor()" style="width: 100%; height: 38px; padding: 0 15px; cursor: pointer;">Buscar</button>
      </div>
      <div class="form-group span-6"><label>Endereço</label><input type="text" id="endereco"></div>
      <div class="form-group span-3"><label>Município</label><input type="text" id="municipio" value="Morada Nova"></div>
      <div class="form-group span-3"><label for="bairro">Bairro</label><select id="bairro" name="bairro" class="form-control"><option value="">Selecione um bairro</option></select></div>
      <div class="form-group span-3"><label>CEP</label><input type="text" id="cep"></div>
      <div class="form-group span-3"><label>Telefone</label><input type="text" id="telefone"></div>
      <div class="form-group span-3"><label>CPF</label><input type="text" id="cpf"></div>
      <div class="form-group span-3"><label>RG</label><input type="text" id="rg"></div>
      <div class="form-group span-3"><label>Data de Expedição</label><input type="date" id="dataExpedicao"></div>
      <div class="form-group span-3"><label>Cargo/Função</label><input type="text" id="cargo"></div>
      <div class="form-group span-6"><label>Lotação</label><select id="lotacao"><option value="">Selecione...</option></select></div>
      <div class="form-group span-6"><label>Unidade de Exercício</label><input type="text" id="unidade"></div>
      <div class="form-group span-6"><label>Tipo de Requerimento</label><select id="tipo"><option value="">Selecione...</option></select></div>
      <div class="form-group span-6"><label>Requer ao</label><select id="requerAo"><option value="">Selecione...</option><option value="SECRETÁRIO">SECRETÁRIO</option><option value="COORDENADOR DE RH">COORDENADOR DE RH</option><option value="PREFEITA">PREFEITA</option></select></div>
      <div class="form-group span-3"><label>Data Solicitação</label><input type="date" id="dataSolicitacao"></div>
      <div class="form-group full-row"><label>Informações Complementares</label><textarea id="complemento" rows="8"></textarea></div>
      <div class="form-group full-row">
          <label for="anexos">Anexar Documentos (limite de 10MB por arquivo)</label>
          <input type="file" id="anexos" multiple onchange="previewFiles(this)">
          <div id="filePreviewContainer" class="file-preview"></div>
      </div>
    </form>
    <button onclick="enviarRequerimento()">Enviar Requerimento</button>
    <button onclick="previsualizarPDF(null, true)">Imprimir</button>
    <a href="{{ url_for('main.menu') }}" class="button-link">Voltar</a>
</div>

<script>
    // Inicialização específica para a página de formulário
    document.addEventListener('DOMContentLoaded', () => {
        popularDropdownsFormulario();
        gerarNumeroProtocolo();
        // Define a data de solicitação padrão como hoje
        const dataSolicitacaoInput = document.getElementById('dataSolicitacao');
        if (!dataSolicitacaoInput.value) {
            dataSolicitacaoInput.value = new Date().toISOString().split('T')[0];
        }
    });
</script>
{% endblock %}
